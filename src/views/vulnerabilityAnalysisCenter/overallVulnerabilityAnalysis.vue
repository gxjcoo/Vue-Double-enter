<template>
  <div>
    <div class="tag">
      <TabsSearch></TabsSearch>
    </div>
    <Title :title="title1" :titleEn="titleEn1" :width="titwidth" @changeBtn="changeBtn" :Btn="false"></Title>
        <div class="box box1">
          <Card cardTitle="现网漏洞总数" borderRadius="10px 0 0 0">
            <div id="charts1" style=" width:100%;height:100%;"></div>
          </Card>
          <Card cardTitle="漏洞级别分布" borderRadius="0 0 0 0">
            <div id="charts2" style=" width:100%;height:100%;"></div>
          </Card>
           <Card cardTitle="漏洞类型占比" borderRadius=" 0 10px 0 0">
            <div id="charts1" style=" width:100%;height:100%;"></div>
          </Card>
        </div>
        <div class="box box2">
        <div class="box-item">
          <Card cardTitle="高危漏洞TOP" borderRadius="0 0 0 10px">
            <div id="charts1" style=" width:100%;height:100%;"></div>
          </Card>
        </div>
        <div class="box-item">
          <Card cardTitle="资产漏洞分布" borderRadius="0 0 0 0">
            <div id="charts2" style=" width:100%;height:100%;"></div>
          </Card>
          <Card cardTitle="漏洞发现趋势" borderRadius="0 0 10px 0">
            <div id="charts3" style=" width:100%;height:100%;"></div>
          </Card>
        </div>
      </div>
  </div>
</template>
<style  lang="less"  scoped>
.tag {
  height: 2.33rem;
}
.box {
  display: flex;
  justify-content: space-between;
  align-items: center;
    padding:0 !important;
    margin:0;
    border-bottom: 2px solid rgba(0, 25, 41, 0.05);
}
.box1{
   height:18.125rem;
   .card{
    border-left: 1px solid rgba(0, 25, 41, 0.05);
   }
}
.box2{
   height:29.66rem;
   .box-item{
       height:29.66rem;
 flex:1;
  .card{
    width: 100%;
    border-left: 1px solid rgba(0, 25, 41, 0.05);
    border-bottom: 1px solid rgba(0, 25, 41, 0.05);
   }
}
.box-item:nth-child(2) > .card{
  height:50%;
}
}
.tdFont {
  font-size: 0.58rem;
  font-family: MicrosoftYaHei;
  font-weight: 400;
}
.tableHead {
  background: #fff;
  color: #606266;
  font-size: 0.58rem;
  font-family: MicrosoftYaHei-Bold;
  font-weight: bold;
  color: "rgba(51,51,51,1)";
}
p {
  width: 7rem;
}
</style>

<script>
import Card from "../../components/common/Card.vue";
import Title from "../../components/common/Title.vue";
import TabsSearch from "../../components/common/TabsSearch";
import echarts from "echarts";

export default {
  data() {
    return {
        title1:'整体漏洞分析',
        titleEn1:'Overall Vulnerability Analysis',
        titwidth:"15rem",
      show: true,
      show2: true,
      tableData: [
        {
          ip: "10.121.62.58",
          type: "命令注入漏洞（10）",
          frequency: "1215",
          time: "2019-12-13 12：32：32 ",
          name: "命令注入攻击Linux/Unix命令执行检测"
        },
        {
          ip: "10.121.62.58",
          type: "命令注入漏洞（10）",
          frequency: "1215",
          time: "2019-12-13 12：32：32 ",
          name: "命令注入攻击Linux/Unix命令执行检测"
        },
        {
          ip: "10.121.62.58",
          type: "命令注入漏洞（10）",
          frequency: "1215",
          time: "2019-12-13 12：32：32 ",
          name: "命令注入攻击Linux/Unix命令执行检测"
        },
        {
          ip: "10.121.62.58",
          type: "命令注入漏洞（10）",
          frequency: "1215",
          time: "2019-12-13 12：32：32 ",
          name: "命令注入攻击Linux/Unix命令执行检测"
        },
        {
          ip: "10.121.62.58",
          type: "命令注入漏洞（10）",
          frequency: "1215",
          time: "2019-12-13 12：32：32 ",
          name: "命令注入攻击Linux/Unix命令执行检测"
        },
        {
          ip: "10.121.62.58",
          type: "命令注入漏洞（10）",
          frequency: "1215",
          time: "2019-12-13 12：32：32 ",
          name: "命令注入攻击Linux/Unix命令执行检测"
        },
        {
          ip: "10.121.62.58",
          type: "命令注入漏洞（10）",
          frequency: "1215",
          time: "2019-12-13 12：32：32 ",
          name: "命令注入攻击Linux/Unix命令执行检测"
        },
        {
          ip: "10.121.62.58",
          type: "命令注入漏洞（10）",
          frequency: "1215",
          time: "2019-12-13 12：32：32 ",
          name: "命令注入攻击Linux/Unix命令执行检测"
        },
        {
          ip: "10.121.62.58",
          type: "命令注入漏洞（10）",
          frequency: "1215",
          time: "2019-12-13 12：32：32 ",
          name: "命令注入攻击Linux/Unix命令执行检测"
        },
        {
          ip: "10.121.62.58",
          type: "命令注入漏洞（10）",
          frequency: "1215",
          time: "2019-12-13 12：32：32 ",
          name: "命令注入攻击Linux/Unix命令执行检测"
        },
        {
          ip: "10.121.62.58",
          type: "命令注入漏洞（10）",
          frequency: "1215",
          time: "2019-12-13 12：32：32 ",
          name: "命令注入攻击Linux/Unix命令执行检测"
        },
        {
          ip: "10.121.62.58",
          type: "命令注入漏洞（10）",
          frequency: "1215",
          time: "2019-12-13 12：32：32 ",
          name: "命令注入攻击Linux/Unix命令执行检测"
        },
        {
          ip: "10.121.62.58",
          type: "命令注入漏洞（10）",
          frequency: "1215",
          time: "2019-12-13 12：32：32 ",
          name: "命令注入攻击Linux/Unix命令执行检测"
        }
      ]
    };
  },
  components: {
    Card,
    Title,
    TabsSearch
  },
  methods: {
    changeBtn(show) {
      this.show = show;
    },
    highAttackChart(el, highPort, horizon) {
      this.chart = echarts.init(document.getElementById(el));
      let port = [],
        data = [];
      for (let item of highPort) {
        port.unshift(item.port);
        data.unshift(item.value);
      }
      var highPortOption = {
        tooltip: {
          trigger: "axis",
          axisPointer: {
            type: "shadow"
          }
        },
        grid: {
          top: "5%",
          bottom: "15%",
          left: "18%",
          right: "5%"
        },
        xAxis: {
          minlnterval: 1,
          boundaryGap: [0, 0.1],
          naineTextStyle: {
            fontSize: "0.2rem"
          },
          axisTick: {
            show: false
          },
          axisLine: {
            lineStyle: { color: "#666666" }
          },
          axisLabel: {
            fontSize: "0.2rem",
            fontWeight: 700
          },
          splitLine: { show: false },
          data: horizon ? port : ""
        },
        yAxis: {
          name: "",
          nameTextStyle: {
            fontSize: "0.2rem",
            fontWeight: 700
          },
          axisTick: {
            show: false
          },
          data: horizon ? "" : port,
          axisLine: {
            lineStyle: {
              color: "#666666"
            }
          },
          splitLine: { show: false },
          axisLabel: {
            fontSize: "0.2rem",
            fontWeight: 700
          }
        },
        series: [
          {
            name: "",
            type: "bar",
            barWidth: 20,
            barMinHeight: 5,
            itemStyle: {
              normal: {
                // color: new echarts.graphic.LinearGradient (0.5, 0, 0, 0, [{
                // offset: 0,
                // color: "#006602"
                // }, {
                // offset: 0,
                color: "#0099FF"
                // }],false)
              }
            },
            data: data
          }
        ]
      };
      this.chart.setOption(highPortOption, true);
    }
  },
  mounted() {
    this.$nextTick(function() {
      this.highAttackChart("charts1", [
        { port: "192.168.1.1", value: 800 },
        { port: "100.2.44.1", value: 100 },
        { port: "192.168.1.1", value: 400 },
        { port: "100", value: 600 },
        { port: "100", value: 800 }
      ]);
      this.highAttackChart("charts2", [
        { port: "192.168.1.1", value: 200 },
        { port: "100.2.44.1", value: 800 },
        { port: "192.168.1.1", value: 400 },
        { port: "100", value: 600 },
        { port: "100", value: 800 }
      ]);
      this.highAttackChart(
        "charts3",
        [
          { port: "项目1", value: 0 },
          { port: "项目2", value: 800 },
          { port: "项目3", value: 200 },
          { port: "项目4", value: 600 },
          { port: "项目5", value: 800 }
        ],
        true
      );
      this.highAttackChart(
        "charts4",
        [
          { port: "项目1", value: 0 },
          { port: "项目2", value: 800 },
          { port: "项目3", value: 200 },
          { port: "项目4", value: 600 },
          { port: "项目5", value: 800 }
        ],
        true
      );
    });
  }
};
</script>
